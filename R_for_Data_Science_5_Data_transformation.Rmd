---
title: "Data-Transformation"
author: "RH"
date: "2023-01-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

options(dplyr.summarise.inform = FALSE)
```

```{r}
# install.packages("tidyverse")
```

```{r}
# install.packages(c("gapminder", "Lahman", "nycflights13", "palmerpenguins", "wakefield"))
```

```{r}
library(nycflights13)
library(tidyverse)
```

```{r}
# filter(flights, month == 1, day==1)
jan1 <- filter(flights, month == 1, day == 1)

(dec25 <- filter(flights, month == 12, day == 25))
```

```{r}
sqrt(2) ^ 2 == 2
#> [1] FALSE
1 / 49 * 49 == 1
#> [1] FALSE
```
```{r}
near(sqrt(2) ^ 2,  2)
#> [1] TRUE
near(1 / 49 * 49, 1)
#> [1] TRUE
```
```{r}
# November or December
filter(flights, month == 11 | month == 12)

nov_dec <- filter(flights, month %in% c(11, 12))
nov_dec
```

```{r}
filter(flights, !(arr_delay > 120 | dep_delay > 120))
filter(flights, arr_delay <= 120, dep_delay <= 120)

```
```{r}
x <- NA
is.na(x)
#> [1] TRUE
```
```{r}
df <- tibble(x = c(1, NA, 3))
filter(df, x > 1)
filter(df, is.na(x) | x > 1)
```
5.2.4 Exercises

1.
```{r}
# 1. Had an arrival delay of two or more hours
filter(flights, arr_delay >= 120)

# 2. Flew to Houston (IAH or HOU)
filter(flights, dest %in% c("IAH","HOU"))

# 3. Were operated by United, American, or Delta
# filter(filters, )

# 4. Departed in summer (July, August, and September)
filter(flights, month %in% c(7,8,9))

# 5. Arrived more than two hours late, but didnâ€™t leave late
filter(flights, dep_delay == 0 & arr_delay >= 120)

# 6. Were delayed by at least an hour, but made up over 30 minutes in flight
filter(flights, dep_delay >= 60, arr_delay <= 30)

# 7. Departed between midnight and 6am (inclusive)
filter(flights, (hour >= 0 & hour <= 5 & minute >= 0 & minute <= 59) | (hour <= 6 & minute <= 0) )

```

2. 
```{r}
filter(flights, between(hour, 0, 6))

```

3.
```{r}
filter(flights, is.na(dep_time))

#8.255

```

4.
```{r}
# ???

```

5.3 Arrange rows with arrange()
```{r}
arrange(flights, year, month, day)
arrange(flights, desc(dep_delay))

```

5.3.1 Exercises

1.
```{r}
# How could you use arrange() to sort all missing values to the start? (Hint: use is.na())
arrange(flights, desc(is.na(flights)))

```

2.
```{r}
# Sort flights to find the most delayed flights. Find the flights that left earliest.
arrange(flights, desc(dep_delay), desc(arr_delay))
arrange(flights, dep_delay)

```
3
```{r}
# Sort flights to find the fastest (highest speed) flights.


```

4
```{r}
# Which flights travelled the farthest? Which travelled the shortest?
arrange(flights, desc(distance))

```

5.4 Select Cloumns with select()
```{r}
# Select columns by name
select(flights, year, month, day)

# Select all columns between year and day (inclusive)
select(flights, year:day)

# Select all columns except those from year to day (inclusive)
select(flights, -(year:day))
```
```{r}
select(flights, time_hour, air_time, everything())
```

5.4.1 Exercises
